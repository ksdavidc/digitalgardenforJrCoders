---
{"dg-publish":true,"permalink":"/digital-garden/hatlight-platformer/"}
---


# Hatlight Platformer

As always, start by creating your **main sprite** and initializing your **variables**. 

- In this case, it is important that **your main sprite is just a square**. Later, we will make it have a real costume, but for now, just a square.
- Initialize usually means things like **position**, **direction**, and **effects**.
- You will also initialize all your **variables**. 
- At the start you don't always know all your variables, but as this is a platformer, we know we will need `x speed `and `y speed`, so let's initialize those.
- To set the **position**, use this trick: Put your sprite at the starting position in the stage. Then the `go to x` block amd scratch will put the correct numbers in the block.

This is what we get:

```ad-scratch
title: main sprite
~~~scratchblock

when @greenFlag clicked
broadcast [initialize v]


when I receive [initialize v]
set [ghost v] effect to (0)::looks
go to x: (-205) y: (65)
set [x speed v] to [0]
set [y speed v] to [0]
~~~
```

After we initialize, we move left right, then fall, then repeat. The flowchart for this is:


<style>
.container {font-family: sans-serif; text-align: center;}
.button-wrapper button {z-index: 1;height: 40px; width: 100px; margin: 10px;padding: 5px;}
.excalidraw .App-menu_top .buttonList { display: flex;}
.excalidraw-wrapper { height: 800px; margin: 50px; position: relative;}
:root[dir="ltr"] .excalidraw .layer-ui__wrapper .zen-mode-transition.App-menu_bottom--transition-left {transform: none;}
</style><script src="https://unpkg.com/react@17/umd/react.production.min.js"></script><script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script><script type="text/javascript" src="https://unpkg.com/@excalidraw/excalidraw@0.12.0/dist/excalidraw.production.min.js"></script><div id="Hatlightflow1.excalidraw.md1"></div><script>(function(){const InitialData={"type":"excalidraw","version":2,"source":"https://excalidraw.com","elements":[{"type":"rectangle","version":1109,"versionNonce":142681311,"isDeleted":false,"id":"4Zo4G_32POJMAp93pe8Jw","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":2,"opacity":100,"angle":0,"x":-789.6038047867507,"y":-1763.5132842981775,"strokeColor":"#5f3dc4","backgroundColor":"#fd7e14","width":190.61711969976747,"height":53.29080765799951,"seed":699179967,"groupIds":[],"strokeSharpness":"round","boundElements":[{"id":"tpbaSfbW","type":"text"},{"id":"dQ51_9u7sE6UPZTRLeunt","type":"arrow"}],"updated":1668807211946,"link":null,"locked":false},{"type":"text","version":1303,"versionNonce":535245055,"isDeleted":false,"id":"tpbaSfbW","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-784.795244936867,"y":-1758.3678804691776,"strokeColor":"#5f3dc4","backgroundColor":"transparent","width":181,"height":43,"seed":263175089,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1668807211948,"link":"[[Digital Garden/scrap|scrap]]","locked":false,"fontSize":33.79879579338343,"fontFamily":1,"text":"Green Flag","rawText":"Green Flag","baseline":30,"textAlign":"center","verticalAlign":"middle","containerId":"4Zo4G_32POJMAp93pe8Jw","originalText":"Green Flag"},{"type":"rectangle","version":922,"versionNonce":585394719,"isDeleted":false,"id":"EwnPpTQMBWRd6B4Ho9_pN","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":2,"opacity":100,"angle":0,"x":-791.6190020800009,"y":-1688.8500103377862,"strokeColor":"#5f3dc4","backgroundColor":"#fd7e14","width":192.25683685847514,"height":63,"seed":1358943199,"groupIds":[],"strokeSharpness":"round","boundElements":[{"id":"BCkK311T","type":"text"}],"updated":1668807211971,"link":null,"locked":false},{"type":"text","version":1042,"versionNonce":1730166079,"isDeleted":false,"id":"BCkK311T","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-786.4905836507633,"y":-1683.8500103377862,"strokeColor":"#5f3dc4","backgroundColor":"transparent","width":182,"height":53,"seed":511647121,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1668807211952,"link":null,"locked":false,"fontSize":41.92573330673702,"fontFamily":1,"text":"Initialize","rawText":"Initialize","baseline":37,"textAlign":"center","verticalAlign":"middle","containerId":"EwnPpTQMBWRd6B4Ho9_pN","originalText":"Initialize"},{"type":"rectangle","version":991,"versionNonce":103446833,"isDeleted":false,"id":"upV35b2z6-7COOfUNmNTN","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":2,"opacity":100,"angle":0,"x":-792.2204601611043,"y":-1589.711042913409,"strokeColor":"#5f3dc4","backgroundColor":"#fd7e14","width":174.6298774023676,"height":53,"seed":1656225791,"groupIds":[],"strokeSharpness":"round","boundElements":[{"id":"KMNdEKbr","type":"text"},{"id":"4fxspMUpYnpbEZlnY9cqH","type":"arrow"}],"updated":1668807211971,"link":null,"locked":false},{"type":"text","version":1109,"versionNonce":3357055,"isDeleted":false,"id":"KMNdEKbr","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-786.9055214599205,"y":-1584.711042913409,"strokeColor":"#5f3dc4","backgroundColor":"transparent","width":164,"height":43,"seed":1153909617,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1668807211956,"link":null,"locked":false,"fontSize":33.59958206026456,"fontFamily":1,"text":"left/Right","rawText":"left/Right","baseline":30,"textAlign":"center","verticalAlign":"middle","containerId":"upV35b2z6-7COOfUNmNTN","originalText":"left/Right"},{"type":"rectangle","version":1120,"versionNonce":987128305,"isDeleted":false,"id":"NVQ2RZglgJ6NGcYxJ4YyE","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":2,"opacity":100,"angle":0,"x":-733.5249125666147,"y":-1495.279852302747,"strokeColor":"#5f3dc4","backgroundColor":"#fd7e14","width":76.6567771695839,"height":72.5574842728147,"seed":1087744031,"groupIds":[],"strokeSharpness":"round","boundElements":[{"id":"yjRqmNVp","type":"text"},{"id":"_twNlxXQC0gzoO951sm2F","type":"arrow"},{"id":"4fxspMUpYnpbEZlnY9cqH","type":"arrow"}],"updated":1668807211958,"link":null,"locked":false},{"type":"text","version":1252,"versionNonce":1920400337,"isDeleted":false,"id":"yjRqmNVp","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-728.1965239818228,"y":-1482.0011101663397,"strokeColor":"#5f3dc4","backgroundColor":"transparent","width":66,"height":46,"seed":516926801,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1668807211959,"link":null,"locked":false,"fontSize":36.32879215365937,"fontFamily":1,"text":"Fall","rawText":"Fall","baseline":32,"textAlign":"center","verticalAlign":"middle","containerId":"NVQ2RZglgJ6NGcYxJ4YyE","originalText":"Fall"},{"type":"arrow","version":3093,"versionNonce":2146894335,"isDeleted":false,"id":"dQ51_9u7sE6UPZTRLeunt","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-692.1856911404916,"y":-1709.7916588572227,"strokeColor":"#000000","backgroundColor":"transparent","width":2.5370765582401154,"height":43.87976298066217,"seed":961104959,"groupIds":[],"strokeSharpness":"round","boundElements":[],"updated":1668807211971,"link":null,"locked":false,"startBinding":{"elementId":"4Zo4G_32POJMAp93pe8Jw","focus":-0.005617377656340597,"gap":1},"endBinding":null,"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[2.5370765582401154,43.87976298066217]]},{"type":"arrow","version":2098,"versionNonce":1618043249,"isDeleted":false,"id":"3e_S01DMbz5ZPctRYMh4C","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-689.7949819872504,"y":-1628.8019027922674,"strokeColor":"#000000","backgroundColor":"transparent","width":1.0543915570658773,"height":49.07639898494726,"seed":1408228145,"groupIds":[],"strokeSharpness":"round","boundElements":[],"updated":1668807211971,"link":null,"locked":false,"startBinding":null,"endBinding":null,"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[-1.0543915570658773,49.07639898494726]]},{"type":"arrow","version":1744,"versionNonce":808439359,"isDeleted":false,"id":"_twNlxXQC0gzoO951sm2F","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-695.7542429564539,"y":-1540.3197306832608,"strokeColor":"#000000","backgroundColor":"transparent","width":2.814805772407871,"height":35.36554010865482,"seed":133393503,"groupIds":[],"strokeSharpness":"round","boundElements":[],"updated":1668807211971,"link":null,"locked":false,"startBinding":null,"endBinding":{"elementId":"NVQ2RZglgJ6NGcYxJ4YyE","focus":-0.17056561530373746,"gap":9.674338271858915},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[-2.814805772407871,35.36554010865482]]},{"type":"arrow","version":4596,"versionNonce":1103506193,"isDeleted":false,"id":"4fxspMUpYnpbEZlnY9cqH","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":2,"opacity":100,"angle":0,"x":-693.0377493131531,"y":-1417.5218294353433,"strokeColor":"#000000","backgroundColor":"transparent","width":112.99533269387969,"height":174.61887294604702,"seed":881806609,"groupIds":[],"strokeSharpness":"round","boundElements":[],"updated":1668807211972,"link":null,"locked":false,"startBinding":{"elementId":"NVQ2RZglgJ6NGcYxJ4YyE","focus":0.27390746705883023,"gap":5.200538594589034},"endBinding":{"elementId":"upV35b2z6-7COOfUNmNTN","focus":-0.5724575221207647,"gap":1.7282528550938423},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[13.641745406564315,33.995772498495825],[108.82122770347318,17.691960690554215],[112.99533269387969,-122.06506140217626],[77.1754194095102,-140.6231004475512]]}],"appState":{"theme":"light","viewBackgroundColor":"transparent","currentItemStrokeColor":"#5f3dc4","currentItemBackgroundColor":"#fd7e14","currentItemFillStyle":"solid","currentItemStrokeWidth":2,"currentItemStrokeStyle":"solid","currentItemRoughness":2,"currentItemOpacity":100,"currentItemFontFamily":2,"currentItemFontSize":28,"currentItemTextAlign":"left","currentItemStrokeSharpness":"round","currentItemStartArrowhead":null,"currentItemEndArrowhead":"arrow","currentItemLinearStrokeSharpness":"round","gridSize":null,"colorPalette":{}},"files":{}};InitialData.scrollToContent=true;App=()=>{const e=React.useRef(null),t=React.useRef(null),[n,i]=React.useState({width:void 0,height:void 0});return React.useEffect(()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height});const e=()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]),React.createElement(React.Fragment,null,React.createElement("div",{className:"excalidraw-wrapper",ref:t},React.createElement(ExcalidrawLib.Excalidraw,{ref:e,width:n.width,height:n.height,initialData:InitialData,viewModeEnabled:!0,zenModeEnabled:!0,gridModeEnabled:!1})))},excalidrawWrapper=document.getElementById("Hatlightflow1.excalidraw.md1");ReactDOM.render(React.createElement(App),excalidrawWrapper);})();</script>

The hexagon means that left/right is the start of a loop. In this case the loop goes forever.

So, let's put in  left/right and fall stacks.

```ad-scratch
title: main sprite
~~~scratchblock
when @greenFlag clicked
   broadcast [initialize v]
   broadcast [move left / right v]


when I receive [move left / right v]
our left right routine will go here
broadcast [fall v]


when I receive [fall v]
our fall routine goes here
broadcast [move left / right v]

~~~
```

So let's do the left right routine. The basic routine is this:

<div id="HatlightFlow2.excalidraw.md2"></div><script>(function(){const InitialData={"type":"excalidraw","version":2,"source":"https://excalidraw.com","elements":[{"type":"rectangle","version":1425,"versionNonce":1329893503,"isDeleted":false,"id":"wcDy_w7SXSk9ohmQLvgLS","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":2,"opacity":100,"angle":0,"x":-251.91063961401403,"y":-237.47329147741908,"strokeColor":"#5f3dc4","backgroundColor":"#fd7e14","width":554,"height":96,"seed":998814719,"groupIds":[],"strokeSharpness":"round","boundElements":[{"id":"QREgwiBu","type":"text"},{"id":"8mSenxo5ScdrK-QKmCdth","type":"arrow"}],"updated":1668807749003,"link":null,"locked":false},{"type":"text","version":1603,"versionNonce":667684351,"isDeleted":false,"id":"QREgwiBu","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-215.41063961401403,"y":-232.47329147741908,"strokeColor":"#5f3dc4","backgroundColor":"transparent","width":481,"height":86,"seed":629919601,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1668807847538,"link":"[[Digital Garden/scrap|scrap]]","locked":false,"fontSize":33.79879579338343,"fontFamily":1,"text":"Detect arrows and set the \nx-speed variable","rawText":"Detect arrows and set the x-speed variable","baseline":73,"textAlign":"center","verticalAlign":"middle","containerId":"wcDy_w7SXSk9ohmQLvgLS","originalText":"Detect arrows and set the x-speed variable"},{"type":"rectangle","version":1275,"versionNonce":1589267505,"isDeleted":false,"id":"NnmCu8ZA7uLUagOYccVAu","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":2,"opacity":100,"angle":0,"x":-252.18183084057938,"y":-103.46953861270862,"strokeColor":"#5f3dc4","backgroundColor":"#fd7e14","width":535,"height":151,"seed":628087839,"groupIds":[],"strokeSharpness":"round","boundElements":[{"id":"Adu5VhNU","type":"text"},{"id":"8mSenxo5ScdrK-QKmCdth","type":"arrow"},{"id":"m71vF6jSLhQz_6pkDWalX","type":"arrow"}],"updated":1668807763818,"link":null,"locked":false},{"type":"text","version":1394,"versionNonce":1360997681,"isDeleted":false,"id":"Adu5VhNU","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-216.18183084057938,"y":-80.96953861270862,"strokeColor":"#5f3dc4","backgroundColor":"transparent","width":463,"height":106,"seed":253933905,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1668807847540,"link":null,"locked":false,"fontSize":41.92573330673702,"fontFamily":1,"text":"Keep x-speed below a \nmaximum speed","rawText":"Keep x-speed below a maximum speed","baseline":90,"textAlign":"center","verticalAlign":"middle","containerId":"NnmCu8ZA7uLUagOYccVAu","originalText":"Keep x-speed below a maximum speed"},{"type":"rectangle","version":1351,"versionNonce":1004041919,"isDeleted":false,"id":"Q5UEJ4Rxw0rzNOBRFvbZY","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":2,"opacity":100,"angle":0,"x":-248.0279511322846,"y":81.86231029613606,"strokeColor":"#5f3dc4","backgroundColor":"#fd7e14","width":535,"height":100,"seed":825541873,"groupIds":[],"strokeSharpness":"round","boundElements":[{"id":"bYdWrPcc","type":"text"},{"id":"m71vF6jSLhQz_6pkDWalX","type":"arrow"},{"id":"dqb1Nxa_P-lBcXJnfPGen","type":"arrow"}],"updated":1668807781074,"link":null,"locked":false},{"type":"text","version":1472,"versionNonce":2097443999,"isDeleted":false,"id":"bYdWrPcc","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-189.0279511322846,"y":105.36231029613606,"strokeColor":"#5f3dc4","backgroundColor":"transparent","width":417,"height":53,"seed":1025179295,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1668807765684,"link":null,"locked":false,"fontSize":41.92573330673702,"fontFamily":1,"text":"change x by x-speed","rawText":"change x by x-speed","baseline":37,"textAlign":"center","verticalAlign":"middle","containerId":"Q5UEJ4Rxw0rzNOBRFvbZY","originalText":"change x by x-speed"},{"type":"rectangle","version":1437,"versionNonce":1949910751,"isDeleted":false,"id":"I2eU_tRX6JKN6bwsBvAmS","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":2,"opacity":100,"angle":0,"x":-240.2663287188555,"y":229.67138176995365,"strokeColor":"#5f3dc4","backgroundColor":"#fd7e14","width":535,"height":74,"seed":15431025,"groupIds":[],"strokeSharpness":"round","boundElements":[{"id":"M2QHvzLB","type":"text"},{"id":"dqb1Nxa_P-lBcXJnfPGen","type":"arrow"}],"updated":1668807781074,"link":null,"locked":false},{"type":"text","version":1562,"versionNonce":402889567,"isDeleted":false,"id":"M2QHvzLB","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-10.766328718855505,"y":240.17138176995365,"strokeColor":"#5f3dc4","backgroundColor":"transparent","width":76,"height":53,"seed":1841665567,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1668807776334,"link":null,"locked":false,"fontSize":41.92573330673702,"fontFamily":1,"text":"Fall","rawText":"Fall","baseline":37,"textAlign":"center","verticalAlign":"middle","containerId":"I2eU_tRX6JKN6bwsBvAmS","originalText":"Fall"},{"type":"arrow","version":539,"versionNonce":607647263,"isDeleted":false,"id":"8mSenxo5ScdrK-QKmCdth","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-24.82286662352641,"y":-140.47329147741908,"strokeColor":"#000000","backgroundColor":"transparent","width":2.9181612085048414,"height":34.506145877228946,"seed":1976403985,"groupIds":[],"strokeSharpness":"round","boundElements":[],"updated":1668807847538,"link":null,"locked":false,"startBinding":{"elementId":"wcDy_w7SXSk9ohmQLvgLS","gap":1,"focus":0.16284224009919607},"endBinding":{"elementId":"NnmCu8ZA7uLUagOYccVAu","gap":2.4976069874814897,"focus":-0.18130019673081207},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[-2.9181612085048414,34.506145877228946]]},{"type":"arrow","version":240,"versionNonce":872701713,"isDeleted":false,"id":"m71vF6jSLhQz_6pkDWalX","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-15.589505057040913,"y":51.854662833339546,"strokeColor":"#000000","backgroundColor":"transparent","width":2.355311819704294,"height":27.501751136782886,"seed":1640182481,"groupIds":[],"strokeSharpness":"round","boundElements":[],"updated":1668807847541,"link":null,"locked":false,"startBinding":{"elementId":"NnmCu8ZA7uLUagOYccVAu","gap":4.324201446048164,"focus":0.13776891935694174},"endBinding":{"elementId":"Q5UEJ4Rxw0rzNOBRFvbZY","gap":2.5058963260136267,"focus":-0.10379461253620226},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[2.355311819704294,27.501751136782886]]},{"type":"arrow","version":78,"versionNonce":705859281,"isDeleted":false,"id":"dqb1Nxa_P-lBcXJnfPGen","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":5.522106933593818,"y":183.00553506387251,"strokeColor":"#000000","backgroundColor":"transparent","width":0.35595308338937315,"height":45.66584670608114,"seed":270372369,"groupIds":[],"strokeSharpness":"round","boundElements":[],"updated":1668807847543,"link":null,"locked":false,"startBinding":{"elementId":"Q5UEJ4Rxw0rzNOBRFvbZY","gap":1.1432247677364558,"focus":0.05058534276254917},"endBinding":{"elementId":"I2eU_tRX6JKN6bwsBvAmS","gap":1,"focus":-0.08351264228812778},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[-0.35595308338937315,45.66584670608114]]}],"appState":{"theme":"light","viewBackgroundColor":"transparent","currentItemStrokeColor":"#000000","currentItemBackgroundColor":"transparent","currentItemFillStyle":"hachure","currentItemStrokeWidth":1,"currentItemStrokeStyle":"solid","currentItemRoughness":1,"currentItemOpacity":100,"currentItemFontFamily":1,"currentItemFontSize":20,"currentItemTextAlign":"center","currentItemStrokeSharpness":"sharp","currentItemStartArrowhead":null,"currentItemEndArrowhead":"arrow","currentItemLinearStrokeSharpness":"round","gridSize":null,"colorPalette":{}},"files":{}};InitialData.scrollToContent=true;App=()=>{const e=React.useRef(null),t=React.useRef(null),[n,i]=React.useState({width:void 0,height:void 0});return React.useEffect(()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height});const e=()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]),React.createElement(React.Fragment,null,React.createElement("div",{className:"excalidraw-wrapper",ref:t},React.createElement(ExcalidrawLib.Excalidraw,{ref:e,width:n.width,height:n.height,initialData:InitialData,viewModeEnabled:!0,zenModeEnabled:!0,gridModeEnabled:!1})))},excalidrawWrapper=document.getElementById("HatlightFlow2.excalidraw.md2");ReactDOM.render(React.createElement(App),excalidrawWrapper);})();</script>


```ad-scratch
title: main sprite
~~~scratchblock
when I receive [move left / right v]
set xspeed::custom
keep speed below max::custom
change x by (x speed)
broadcast [fall v]
~~~
```



Changing the speed is now easy. If no key is being held, then slow the speed down. Otherwise, speed  up in the direction we are going.

```ad-scratch
title: 
~~~scratchblock

define set xspeed
if <<not <key [left arrow v] pressed?>> and <not <key [right arrow v] pressed?>>> then
   no key is being pressed so we decrease speed
   if moving left, go a little less left, if going right, go a little less right.
   if moving left, make xspeed bigger, if going right, make xspeed smaller
   moving left +1 right -1
   moving left means speed IS LESS THAN 0,  right means speed IS MORE THAN 0
   change [x speed v] by (<(x speed) \< [0]> - <(x speed) \> [0]>)
else
    /: [else go in direction of arrow]::custom
    change [x speed v] by (<key [right arrow v] pressed?> - <key [left arrow v] pressed?>)
end


~~~
```

Keeping the speed below the max is easy, but we have to remember that left and right are different.
```ad-scratch
title: 
~~~scratchblock


define keep speed below max
/: [set maximum speed]::custom
moving right:
if <(x speed) \> [4]> then
    set [x speed v] to [4]
end
moving left:
if <(x speed) \< [-4]> then
    set [x speed v] to [-4]
end
~~~
```

# Falling

Next we will teach our guy to fall. First, we need a platform or wall for the character to fall onto. So make one. 

Our basic fall routine is 

<div id="HatlightFalling.excalidraw.md3"></div><script>(function(){const InitialData={"type":"excalidraw","version":2,"source":"https://excalidraw.com","elements":[{"type":"rectangle","version":1254,"versionNonce":1862750303,"isDeleted":false,"id":"pbYWMc1ELCkT-FFdAdOjv","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":2,"opacity":100,"angle":0,"x":-230.83915201822913,"y":-273.93043009440106,"strokeColor":"#5f3dc4","backgroundColor":"#fd7e14","width":535,"height":151,"seed":123374769,"groupIds":[],"strokeSharpness":"round","boundElements":[{"id":"6JTUU39S","type":"text"}],"updated":1668808075969,"link":null,"locked":false},{"type":"text","version":1372,"versionNonce":688977791,"isDeleted":false,"id":"6JTUU39S","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-206.33915201822913,"y":-251.43043009440106,"strokeColor":"#5f3dc4","backgroundColor":"transparent","width":486,"height":105,"seed":451318495,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1668807971559,"link":null,"locked":false,"fontSize":41.92573330673702,"fontFamily":1,"text":"Change the y speed by\ngravity","rawText":"Change the y speed by gravity","baseline":90,"textAlign":"center","verticalAlign":"middle","containerId":"pbYWMc1ELCkT-FFdAdOjv","originalText":"Change the y speed by gravity"},{"type":"rectangle","version":1316,"versionNonce":655747487,"isDeleted":false,"id":"6v7fxz3OiAJMVK3DSu8oU","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":2,"opacity":100,"angle":0,"x":-228.30709249931473,"y":-78.10794120922424,"strokeColor":"#5f3dc4","backgroundColor":"#fd7e14","width":535,"height":169,"seed":1041138655,"groupIds":[],"strokeSharpness":"round","boundElements":[{"id":"352MeiVz","type":"text"},{"id":"APMn23j8Spng2klijuSQO","type":"arrow"},{"id":"9rZ9noFihhgbHvIPsmZ0d","type":"arrow"}],"updated":1668808059863,"link":null,"locked":false},{"type":"text","version":1437,"versionNonce":1996877745,"isDeleted":false,"id":"352MeiVz","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-223.30709249931473,"y":-46.607941209224236,"strokeColor":"#5f3dc4","backgroundColor":"transparent","width":525,"height":105,"seed":1391685009,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1668807995203,"link":null,"locked":false,"fontSize":41.92573330673702,"fontFamily":1,"text":"Change the y position by\nthe y speed","rawText":"Change the y position by the y speed","baseline":90,"textAlign":"center","verticalAlign":"middle","containerId":"6v7fxz3OiAJMVK3DSu8oU","originalText":"Change the y position by the y speed"},{"type":"rectangle","version":1375,"versionNonce":395112529,"isDeleted":false,"id":"WasJtU11VxdOvyDuslFJ5","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":2,"opacity":100,"angle":0,"x":-225.00340940241233,"y":146.00709185683934,"strokeColor":"#5f3dc4","backgroundColor":"#fd7e14","width":535,"height":169,"seed":74318769,"groupIds":[],"strokeSharpness":"round","boundElements":[{"id":"mVlvDa8Z","type":"text"},{"id":"9rZ9noFihhgbHvIPsmZ0d","type":"arrow"},{"id":"AYu0YRbL_H6urP9AFavNV","type":"arrow"}],"updated":1668808064751,"link":null,"locked":false},{"type":"text","version":1503,"versionNonce":714969631,"isDeleted":false,"id":"mVlvDa8Z","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-158.50340940241233,"y":177.50709185683934,"strokeColor":"#5f3dc4","backgroundColor":"transparent","width":402,"height":105,"seed":1143606239,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1668808043257,"link":null,"locked":false,"fontSize":41.92573330673702,"fontFamily":1,"text":"If inside a wall or\nplatform, pull out","rawText":"If inside a wall or platform, pull out","baseline":90,"textAlign":"center","verticalAlign":"middle","containerId":"WasJtU11VxdOvyDuslFJ5","originalText":"If inside a wall or platform, pull out"},{"type":"rectangle","version":1426,"versionNonce":58849361,"isDeleted":false,"id":"MTTvhJ55ijdKv_8p6iFAn","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":2,"opacity":100,"angle":0,"x":-221.94110428659536,"y":366.3850418893916,"strokeColor":"#5f3dc4","backgroundColor":"#fd7e14","width":535,"height":169,"seed":964029777,"groupIds":[],"strokeSharpness":"round","boundElements":[{"id":"DvAEVm7X","type":"text"}],"updated":1668808052047,"link":null,"locked":false},{"type":"text","version":1558,"versionNonce":1744122175,"isDeleted":false,"id":"DvAEVm7X","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-141.44110428659536,"y":397.8850418893916,"strokeColor":"#5f3dc4","backgroundColor":"transparent","width":374,"height":106,"seed":858197055,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1668808052048,"link":null,"locked":false,"fontSize":41.92573330673702,"fontFamily":1,"text":"Go back to move \nleft/right","rawText":"Go back to move left/right","baseline":90,"textAlign":"center","verticalAlign":"middle","containerId":"MTTvhJ55ijdKv_8p6iFAn","originalText":"Go back to move left/right"},{"id":"APMn23j8Spng2klijuSQO","type":"arrow","x":2.0899037143640844,"y":-123.21980553342587,"width":1.3597347861842195,"height":44.01444284539474,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"strokeSharpness":"round","seed":1155253407,"version":116,"versionNonce":1679534353,"isDeleted":false,"boundElements":null,"updated":1668808075969,"link":null,"locked":false,"points":[[0,0],[1.3597347861842195,44.01444284539474]],"lastCommittedPoint":null,"startBinding":null,"endBinding":{"elementId":"6v7fxz3OiAJMVK3DSu8oU","focus":-0.12253844389034559,"gap":1.0974214788068934},"startArrowhead":null,"endArrowhead":"arrow"},{"id":"9rZ9noFihhgbHvIPsmZ0d","type":"arrow","x":13.844118352522003,"y":93.86997396904127,"width":0.24285567434213817,"height":50.20083778782896,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"strokeSharpness":"round","seed":1101695,"version":84,"versionNonce":390089343,"isDeleted":false,"boundElements":null,"updated":1668808073407,"link":null,"locked":false,"points":[[0,0],[0.24285567434213817,50.20083778782896]],"lastCommittedPoint":null,"startBinding":{"elementId":"6v7fxz3OiAJMVK3DSu8oU","focus":0.09619684380220084,"gap":2.977915178265505},"endBinding":{"elementId":"WasJtU11VxdOvyDuslFJ5","focus":-0.10448132730631562,"gap":1.9362800999691103},"startArrowhead":null,"endArrowhead":"arrow"},{"id":"AYu0YRbL_H6urP9AFavNV","type":"arrow","x":20.944241707785125,"y":315.8720555891072,"width":1.4205129523026585,"height":52.93200041118416,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"strokeSharpness":"round","seed":1121427889,"version":87,"versionNonce":506575921,"isDeleted":false,"boundElements":null,"updated":1668808068687,"link":null,"locked":false,"points":[[0,0],[1.4205129523026585,52.93200041118416]],"lastCommittedPoint":null,"startBinding":{"elementId":"WasJtU11VxdOvyDuslFJ5","focus":0.08838438412637474,"gap":1},"endBinding":null,"startArrowhead":null,"endArrowhead":"arrow"},{"id":"Dq6k9mXo3osgwMH-FwAtp","type":"arrow","x":289.0390453673247,"y":-318.0512521308766,"width":142.5565378289474,"height":359.9313193873357,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"strokeSharpness":"round","seed":381481265,"version":177,"versionNonce":597463391,"isDeleted":true,"boundElements":null,"updated":1668808030555,"link":null,"locked":false,"points":[[0,0],[-46.21273643092104,7.579409950657919],[85.31918174342104,-10.55056923314146],[96.34380139802636,119.62958084909545],[88.49468030427636,261.4721037212172],[70.67742598684208,349.38075015419423],[23.068719161184276,248.6559094880758]],"lastCommittedPoint":[23.068719161184276,248.6559094880758],"startBinding":null,"endBinding":{"elementId":"6v7fxz3OiAJMVK3DSu8oU","focus":-1.004217902121955,"gap":5.414857027823757},"startArrowhead":null,"endArrowhead":"arrow"},{"id":"papvSVzf","type":"text","x":-261.7359083744518,"y":521.5506894295679,"width":12,"height":25,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"strokeSharpness":"sharp","seed":1204131103,"version":3,"versionNonce":364091711,"isDeleted":true,"boundElements":null,"updated":1668808039489,"link":null,"locked":false,"text":"","rawText":"","fontSize":20,"fontFamily":1,"textAlign":"left","verticalAlign":"top","baseline":18,"containerId":null,"originalText":""}],"appState":{"theme":"light","viewBackgroundColor":"transparent","currentItemStrokeColor":"#000000","currentItemBackgroundColor":"transparent","currentItemFillStyle":"hachure","currentItemStrokeWidth":1,"currentItemStrokeStyle":"solid","currentItemRoughness":1,"currentItemOpacity":100,"currentItemFontFamily":1,"currentItemFontSize":20,"currentItemTextAlign":"left","currentItemStrokeSharpness":"sharp","currentItemStartArrowhead":null,"currentItemEndArrowhead":"arrow","currentItemLinearStrokeSharpness":"round","gridSize":null,"colorPalette":{}},"files":{}};InitialData.scrollToContent=true;App=()=>{const e=React.useRef(null),t=React.useRef(null),[n,i]=React.useState({width:void 0,height:void 0});return React.useEffect(()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height});const e=()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]),React.createElement(React.Fragment,null,React.createElement("div",{className:"excalidraw-wrapper",ref:t},React.createElement(ExcalidrawLib.Excalidraw,{ref:e,width:n.width,height:n.height,initialData:InitialData,viewModeEnabled:!0,zenModeEnabled:!0,gridModeEnabled:!1})))},excalidrawWrapper=document.getElementById("HatlightFalling.excalidraw.md3");ReactDOM.render(React.createElement(App),excalidrawWrapper);})();</script>

We could change the y position by y speed in big jumps, but it might turn out we will jump beyond the platform, so instead we will change y by 1 step y-speed times. 


```ad-scratch
title: 
~~~scratchblock

when I receive [fall v]
change [y speed v] by (-1)
change y  by 1 (y speed) times or until touching wall::custom
/: [At this point we may be touching a wall]::custom
/: [if so, we should pull out of the wall]::custom
/: [our speed +/- tells us whether we are either moving up (ceiling\) or down (floor\)]::custom
pull up or down if touching walls depending on whether we were <(y speed) \> [0]> or not::custom
broadcast [move left / right v]

~~~
```


To be continued...
